(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(n,e,t){},16:function(n,e,t){},18:function(n,e,t){},20:function(n,e,t){},22:function(n,e,t){"use strict";t.r(e);var o=t(1),a=t.n(o),i=t(8),r=t.n(i),l=(t(14),t(2)),c=t(3),d=t(5),u=t(4),s=t(6),f=(t(16),t(0));function h(n){var e=new f.j,t=window.innerWidth/window.innerHeight,o=new f.h(40*t/-2,40*t/2,20,-20,1,2e3),a=new f.m({canvas:n,antialias:!0});return a.setSize(window.innerWidth,window.innerHeight),window.addEventListener("resize",function(){var n=window.innerHeight,e=window.innerWidth;a.setSize(e,n),o.aspect=e/n,o.updateProjectionMatrix()},!1),o.rotation.x=Math.PI/4,o.position.z=60,function(){var n=new f.e(11184810,0,.9),e=new f.c(16777215,.9);e.position.set(150,350,350);var t=new f.a(14452852,.5);return[n,e,t]}().forEach(function(n){return e.add(n)}),{scene:e,camera:o,renderer:a}}var w=function(n){var e=n.headLength;return-(n.bodyLength+e)/2},p=[{headLength:1,headColor:2562932,bodyLength:.5,bodyColor:2562932,tailLength:.4,tailColor:16770816,flapLength:.3,flapColor:16770816,flapType:"bottom",eyeColor:7677244},{headLength:.5,headColor:16480275,bodyLength:1.5,bodyColor:8600660,tailLength:.45,tailColor:4861671,flapLength:.25,flapColor:4861671,flapType:"bottom",eyeColor:6047650},{headLength:1,headColor:8352334,bodyLength:0,tailLength:.45,tailColor:2563595,flapLength:.35,flapColor:1729357,flapType:"both",eyeColor:6632466}];function g(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=p[n],t=new f.d;return t.add(function(n){var e=new f.b(n.headLength,1,1),t=new f.g({color:n.headColor,flatShading:!0}),o=new f.f(e,t);return o.position.x=w(n),o}(e)),e.bodyLength>0&&t.add(function(n){var e=new f.b(n.bodyLength,.8,.8),t=new f.g({color:n.bodyColor,flatShading:!0}),o=new f.f(e,t);return o.position.x=n.headLength/2+n.bodyLength/2+w(n),o}(e)),t.add(function(n){var e=new f.d,t=new f.b(n.tailLength,n.tailLength,n.tailLength),o=new f.g({color:n.tailColor,flatShading:!0}),a=new f.f(t,o);e.add(a);var i=new f.b(3*n.tailLength,.5*n.tailLength,.05),r=new f.g({color:n.tailColor,flatShading:!0}),l=new f.f(i,r);l.rotation.z=-.4,e.add(l);var c=new f.b(3*n.tailLength,.5*n.tailLength,.05),d=new f.g({color:n.tailColor,flatShading:!0}),u=new f.f(c,d);return u.rotation.z=.4,e.add(u),e.position.x=n.bodyLength+n.headLength/2+w(n),e}(e)),t.add(function(n){if("both"===n.flapType){var e=new f.d,t=3*n.flapLength,o=new f.b(t,.5*n.flapLength,.05),a=new f.g({color:n.flapColor,flatShading:!0}),i=new f.f(o,a);i.rotation.z=.8,i.position.y=.5,i.position.x=-t/2+.1,e.add(i);var r=new f.b(t,.5*n.flapLength,.05),l=new f.g({color:n.flapColor,flatShading:!0}),c=new f.f(r,l);return c.rotation.z=-.8,c.position.y=-.5,c.position.x=-t/2+.1,e.add(c),e}var d=new f.b(.2*n.bodyLength,n.flapLength,.25),u=new f.g({color:n.flapColor,flatShading:!0}),s=new f.f(d,u);return s.position.x=n.headLength/2+n.bodyLength/2+w(n),s.position.y=-(.4+n.flapLength/2),s}(e)),t.add(function(n){var e=new f.b(.1,.16,.16),t=new f.g({color:n.eyeColor,flatShading:!0}),o=new f.f(e,t);return o.position.x=-(n.headLength/2+.08)+w(n),o.position.y=.15,o.position.z=.25,o}(e)),t.add(function(n){var e=new f.b(.1,.16,.16),t=new f.g({color:n.eyeColor,flatShading:!0}),o=new f.f(e,t);return o.position.x=-(n.headLength/2+.08)+w(n),o.position.y=.15,o.position.z=-.25,o}(e)),t}function v(){var n=new f.d;return n.add(function(){var n=new f.b(2,2,.25),e=new f.g({color:2699324,flatShading:!0}),t=new f.f(n,e);return t.rotation.z=Math.PI/4,t}()),n.add(function(){var n=new f.b(2.5,.1,.1),e=new f.g({color:1645860,flatShading:!0}),t=new f.f(n,e);return t.position.x=2,t}()),n.add(function(){var n=new f.b(.15,.15,.15),e=new f.g({color:1645860,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.5,t.position.y=.3,t.position.z=.15,t}()),n.add(function(){var n=new f.b(.15,.15,.15),e=new f.g({color:1645860,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.5,t.position.y=-.3,t.position.z=.15,t}()),n}function y(){var n=new f.d;return n.add(function(){var n=new f.b(.5,1,1),e=new f.g({color:4464908,flatShading:!0});return new f.f(n,e)}()),n.add(function(){var n=new f.b(.5,1.1,1),e=new f.g({color:3283209,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.5,t}()),n.add(function(){var n=new f.b(.5,.9,1),e=new f.g({color:5843984,flatShading:!0}),t=new f.f(n,e);return t.position.x=.5,t}()),n.add(function(){var n=new f.b(.5,.8,1),e=new f.g({color:7288339,flatShading:!0}),t=new f.f(n,e);return t.position.x=1,t}()),n.add(function(){var n=new f.b(.5,.6,1),e=new f.g({color:10046235,flatShading:!0}),t=new f.f(n,e);return t.position.x=2,t}()),n.add(function(){var n=new f.b(.5,.7,1),e=new f.g({color:9258265,flatShading:!0}),t=new f.f(n,e);return t.position.x=1.5,t}()),n.add(function(){var n=new f.b(.1,.16,.16),e=new f.g({color:10046235,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.75,t.position.y=.25,t.position.z=.5,t}()),n.add(function(){var n=new f.b(.1,.16,.16),e=new f.g({color:10046235,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.75,t.position.y=-.25,t.position.z=.5,t}()),n}var m=10,b=1321784;function S(n,e){var t=new f.d;return t.add(function(n,e){for(var t=new f.i(n,e,Math.round(n/5),Math.round(e/5)),o=t.attributes.position.array,a=0,i=0,r=o.length;a<r;a++,i+=3)o[i+2]=.2*Math.random();var l=new f.g({color:739435,flatShading:!0});return new f.f(t,l)}(n,e)),t.add(x(n,e,-1)),t.add(x(n,e,1)),t.add(L(n,e,-1)),t.add(L(n,e,1)),t.position.z=-2,t}function x(n,e,t){var o=new f.b(n,100,m),a=new f.g({color:b,flatShading:!0}),i=new f.f(o,a);return i.position.y=(e/2+50)*t,i}function L(n,e,t){var o=new f.b(100,e+200,m),a=new f.g({color:b,flatShading:!0}),i=new f.f(o,a);return i.position.x=(e/2+50)*t,i}var C=14990609;function E(){var n=new f.d,e=new f.d;return e.add(function(){var n=new f.b(2.5,1,1.5),e=new f.g({color:C,flatShading:!0});return new f.f(n,e)}()),e.add(function(){var n=new f.b(1.5,.5,1),e=new f.g({color:C,flatShading:!0}),t=new f.f(n,e);return t.position.y=.75,t}()),e.add(function(){var n=new f.b(.25,1,.25),e=new f.g({color:C,flatShading:!0}),t=new f.f(n,e);return t.position.y=1.25,t}()),e.add(function(){var n=new f.b(1,.25,.25),e=new f.g({color:C,flatShading:!0}),t=new f.f(n,e);return t.position.x=-.375,t.position.y=1.75,t}()),e.add(function(){var n=new f.b(.2,.2,.2),e=new f.g({color:C,flatShading:!0}),t=new f.f(n,e);return t.position.x=1.3,t}()),e.add(function(){var n=new f.b(.25,1,.25),e=new f.g({color:C,flatShading:!0}),t=new f.f(n,e);return t.position.x=1.5,t.rotation.x=.3,t}()),e.scale.x=2.5,e.scale.y=2.5,e.scale.z=2.5,e.rotation.x=Math.PI/2,n.add(e),n}var O=3,j=15,z=20,M=2,k=10,T=.03,R=.9,P=.2;function F(n,e,t){var o=function(n,e){var t=e.filter(function(e){var t=n.position.distanceTo(e.position);return t<O});if(0===t.length)return new f.l(0,0,0);return t.reduce(function(e,t){return n.position.clone().sub(t.position).add(e)},new f.l).divideScalar(t.length)}(n,e).multiplyScalar(M),a=function(n,e){var t=e.filter(function(e){var t=n.position.distanceTo(e.position);return t<j});if(0===t.length)return new f.l(0,0,0);return t.reduce(function(n,e){return n.add(e.velocity)},new f.l).divideScalar(t.length)}(n,e).multiplyScalar(k),i=function(n,e){var t=e.filter(function(e){var t=n.position.distanceTo(e.position);return t<j});if(0===t.length)return new f.l(0,0,0);return t.reduce(function(n,e){return n.add(e.position)},new f.l).divideScalar(t.length).divideScalar(100).sub(n.position).normalize()}(n,e).multiplyScalar(T),r=function(n,e){if(!e||e&&n.position.distanceTo(e.position)>z)return new f.l(0,0,0);return e.position.clone().sub(n.position)}(n,t).multiplyScalar(R);return{acceleration:o.add(a).add(i).add(r).divideScalar(400),separation:o,alignment:a,cohesion:i}}t(18);function H(){return a.a.createElement("div",{className:"gameOver"},a.a.createElement("h1",null,"You have found all the fish!"),a.a.createElement("p",null,"Game built for the NodeKO 2018 hackathon by ",a.a.createElement("a",{href:"https://github.com/pirelenito/"},"pirelenito")," and"," ",a.a.createElement("a",{href:"https://github.com/jucomin/"},"jucomin")," "),a.a.createElement("a",{href:"https://www.nodeknockout.com/entries/7-macaco-maluco/vote"},"\u27a1 Vote for Us"),a.a.createElement("a",{href:"/"},"\u27a1 Restart"))}t(20);var I=200,W=200,D=4*P,N=function(n){function e(n){var t;Object(l.a)(this,e),(t=Object(d.a)(this,Object(u.a)(e).call(this,n))).ref=Object(o.createRef)(),t.votingRef=Object(o.createRef)(),t.state={score:0,gameOver:!1},t.player={position:new f.l(0,0,0),velocity:new f.l(.2,.4,0),acceleration:new f.l(0,0,0),maxSpeed:0},t.creatures=[];for(var a=0;a<50;a++)t.creatures.push({position:new f.l(Math.random()*I-I/2,Math.random()*W-W/2,0),velocity:new f.l(2*Math.random()*P-P/2,2*Math.random()*P-P/2,0),creatureType:Math.floor(5*Math.random())});return t.mousePosition=[window.width/2,window.height/2],t}return Object(s.a)(e,n),Object(c.a)(e,[{key:"componentDidMount",value:function(){var n=this,e=h(this.ref.current),t=e.camera,o=e.scene,a=e.renderer,i=S(I,W);o.add(i);var r=E();o.add(r);var l=this.creatures.map(function(n){var e,t=n.creatureType;return 3===(e=t)?v():4===e?y():g(e)});l.forEach(function(n){return o.add(n)});!function e(){n.creatures.forEach(function(e,t){var o=F(e,n.creatures.filter(function(n,e){return e!==t}),n.player).acceleration;e.velocity.add(o).clampScalar(-P,P),e.position.add(e.velocity),Y(e);var a=new f.k(e.velocity.x,e.velocity.y).angle()+Math.PI,i=l[t];i.position.x=e.position.x,i.position.y=e.position.y,i.position.z=.001*t,i.rotation.z=a}),n.player.velocity.add(n.player.acceleration).clampScalar(-n.player.maxSpeed,n.player.maxSpeed),n.player.position.add(n.player.velocity),Y(n.player),t.position.x=n.player.position.x,t.position.y=n.player.position.y-55;var i=new f.k(n.player.velocity.x,n.player.velocity.y).angle()+Math.PI;r.position.x=n.player.position.x,r.position.y=n.player.position.y,r.rotation.z=i,a.render(o,t);var c=n.creatures.filter(function(e){return n.player.position.distanceTo(e.position)<20}).length,d=c===n.creatures.length;n.setState({score:c,gameOver:d}),d||requestAnimationFrame(e)}();var c=function(e){e.preventDefault();var t=e.touches?e.touches[0]:e;n.player.acceleration.x=(t.clientX-window.innerWidth/2)/(window.innerWidth/2)/(window.innerWidth/2)*4,n.player.acceleration.y=-(t.clientY-window.innerHeight/2)/(window.innerHeight/2)/(window.innerHeight/2)*4;var o=new f.k(window.innerWidth/2,window.innerHeight/2),a=new f.k(t.clientX,t.clientY),i=new f.k;n.player.maxSpeed=o.distanceTo(a)/o.distanceTo(i)*D};window.addEventListener("touchstart",function(n){n.preventDefault()}),window.addEventListener("touchmove",c),window.addEventListener("mousemove",c)}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"score"},this.state.score," / ",this.creatures.length),this.state.gameOver&&a.a.createElement(H,null),a.a.createElement("canvas",{id:"game",ref:this.ref}))}}]),e}(o.Component);function Y(n){(n.position.x<-I/2||n.position.x>I/2)&&(n.velocity.x=-n.velocity.x),(n.position.y<-I/2||n.position.y>I/2)&&(n.velocity.y=-n.velocity.y)}var q=function(n){function e(n){var t;return Object(l.a)(this,e),(t=Object(d.a)(this,Object(u.a)(e).call(this,n))).ref=Object(o.createRef)(),t}return Object(s.a)(e,n),Object(c.a)(e,[{key:"componentDidMount",value:function(){var n=h(this.ref.current),e=n.camera,t=n.scene,o=n.renderer,a=this.props,i=a.rotate,r=a.fish,l=a.player,c=a.stingRay,d=a.siameseFish;e.position.z=4;var u=d?y():l?E():c?v():g(r);t.add(u),function n(){i&&(u.rotation.y-=-.01),o.render(t,e),requestAnimationFrame(n)}()}},{key:"render",value:function(){return a.a.createElement("canvas",{id:"game",ref:this.ref})}}]),e}(o.Component),A=function(n){function e(){return Object(l.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(s.a)(e,n),Object(c.a)(e,[{key:"render",value:function(){var n=new URLSearchParams(window.location.search);return n.get("fish")||n.get("stingRay")||n.get("player")||n.get("siameseFish")?a.a.createElement(q,{fish:parseInt(n.get("fish"),10),stingRay:!!n.get("stingRay"),player:"true"===n.get("player"),siameseFish:"true"===n.get("siameseFish"),rotate:"true"===n.get("rotate")}):a.a.createElement(N,null)}}]),e}(o.Component);r.a.render(a.a.createElement(A,null),document.getElementById("root"))},9:function(n,e,t){n.exports=t(22)}},[[9,2,1]]]);
//# sourceMappingURL=main.84291745.chunk.js.map